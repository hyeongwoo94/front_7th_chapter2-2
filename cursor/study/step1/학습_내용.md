# ë‹¨ê³„ 1: VNodeì™€ ê¸°ì´ˆ ìœ í‹¸ë¦¬í‹° - í•™ìŠµ ê°€ì´ë“œ

## ğŸ¯ ì´ ë‹¨ê³„ì—ì„œ ë°°ìš°ëŠ” ê²ƒ

ë‹¨ê³„ 1ì—ì„œëŠ” Reactì˜ ê°€ì¥ ê¸°ì´ˆê°€ ë˜ëŠ” **Virtual DOMì˜ ê¸°ë³¸ êµ¬ì¡°**ë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤. JSXê°€ ì–´ë–»ê²Œ Virtual DOMìœ¼ë¡œ ë³€í™˜ë˜ëŠ”ì§€, ê·¸ë¦¬ê³  ê°’ ë¹„êµ í•¨ìˆ˜ë“¤ì´ ì–´ë–»ê²Œ ë™ì‘í•˜ëŠ”ì§€ ë°°ì›ë‹ˆë‹¤.

---

## ğŸ“š í•µì‹¬ ê°œë…

### 1. Virtual DOMì´ë€?

**Virtual DOM(ê°€ìƒ DOM)**ì€ ì‹¤ì œ DOMê³¼ ë™ì¼í•œ êµ¬ì¡°ë¥¼ ê°€ì§„ JavaScript ê°ì²´ì…ë‹ˆë‹¤. ReactëŠ” ì‹¤ì œ DOMì„ ì§ì ‘ ì¡°ì‘í•˜ì§€ ì•Šê³ , Virtual DOMì„ í†µí•´ ë³€ê²½ ì‚¬í•­ì„ ì¶”ì í•˜ê³  ìµœì†Œí•œì˜ DOM ì—…ë°ì´íŠ¸ë§Œ ìˆ˜í–‰í•©ë‹ˆë‹¤.

**ì™œ í•„ìš”í•œê°€?**

- ì‹¤ì œ DOM ì¡°ì‘ì€ ë¹„ìš©ì´ í½ë‹ˆë‹¤ (ë Œë”ë§, ë¦¬í”Œë¡œìš°, ë¦¬í˜ì¸íŠ¸)
- Virtual DOMìœ¼ë¡œ ë³€ê²½ ì‚¬í•­ì„ ê³„ì‚°í•œ ë’¤ í•œ ë²ˆì— ì—…ë°ì´íŠ¸í•˜ë©´ ì„±ëŠ¥ì´ í–¥ìƒë©ë‹ˆë‹¤
- ë³µì¡í•œ UI ìƒíƒœ ê´€ë¦¬ë¥¼ ì‰½ê²Œ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤

### 2. VNode êµ¬ì¡°

VNodeëŠ” Virtual DOMì˜ ë…¸ë“œë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê°ì²´ì…ë‹ˆë‹¤:

```typescript
type VNode = {
  type: string | symbol | ComponentType; // ìš”ì†Œ íƒ€ì…
  props: {
    children?: VNode[]; // ìì‹ ë…¸ë“œë“¤
    [key: string]: any; // ê¸°íƒ€ ì†ì„±
  };
  key?: string | number; // ë¦¬ìŠ¤íŠ¸ ë Œë”ë§ìš© í‚¤
};
```

**ì˜ˆì‹œ:**

```tsx
// JSX
<div className="container">
  <h1>Hello</h1>
  <p>World</p>
</div>

// VNodeë¡œ ë³€í™˜
{
  type: "div",
  props: {
    className: "container",
    children: [
      { type: "h1", props: { children: ["Hello"] } },
      { type: "p", props: { children: ["World"] } }
    ]
  }
}
```

### 3. TEXT_ELEMENTì™€ Fragment

#### TEXT_ELEMENT

ë¬¸ìì—´ì´ë‚˜ ìˆ«ì ê°™ì€ ì›ì‹œ ê°’ì€ í…ìŠ¤íŠ¸ ë…¸ë“œë¡œ ë³€í™˜ë©ë‹ˆë‹¤:

```typescript
export const TEXT_ELEMENT = Symbol.for("react.text");

// ì‚¬ìš© ì˜ˆ
{
  type: TEXT_ELEMENT,
  props: { nodeValue: "Hello" }
}
```

#### Fragment

FragmentëŠ” ì‹¤ì œ DOM ìš”ì†Œ ì—†ì´ ìì‹ë§Œ ë Œë”ë§í•©ë‹ˆë‹¤:

```typescript
export const Fragment = Symbol.for("react.fragment");

// ì‚¬ìš© ì˜ˆ
<>
  <div>Item 1</div>
  <div>Item 2</div>
</>
```

---

## ğŸ”§ êµ¬í˜„í•´ì•¼ í•  í•¨ìˆ˜ë“¤

### 1. `isEmptyValue(value)`

**ì—­í• **: ë Œë”ë§í•˜ì§€ ì•Šì•„ì•¼ í•  ê°’ë“¤ì„ í•„í„°ë§í•©ë‹ˆë‹¤.

**í•„í„°ë§ ëŒ€ìƒ**:

- `null` - ì—†ìŒ
- `undefined` - ì •ì˜ë˜ì§€ ì•ŠìŒ
- `boolean` (true/false) - Reactì—ì„œ booleanì€ ë Œë”ë§ë˜ì§€ ì•ŠìŒ

**ì‚¬ìš© ì˜ˆ**:

```typescript
isEmptyValue(null); // true
isEmptyValue(undefined); // true
isEmptyValue(true); // true
isEmptyValue(false); // true
isEmptyValue(0); // false (0ì€ ìœ íš¨í•œ ê°’)
isEmptyValue(""); // false (ë¹ˆ ë¬¸ìì—´ë„ ìœ íš¨)
```

### 2. `shallowEquals(a, b)`

**ì—­í• **: ì–•ì€ ë¹„êµ - 1ë‹¨ê³„ ê¹Šì´ë§Œ ë¹„êµí•©ë‹ˆë‹¤.

**ë™ì‘ ë°©ì‹**:

1. `Object.is()`ë¡œ ì°¸ì¡° ë™ì¼ì„± í™•ì¸
2. íƒ€ì…ì´ ë‹¤ë¥´ë©´ `false`
3. ê°ì²´/ë°°ì—´: í‚¤ ê°œìˆ˜ ë¹„êµ â†’ ê° í‚¤ ê°’ ë¹„êµ (1ë‹¨ê³„ë§Œ)

**ì˜ˆì‹œ**:

```typescript
shallowEquals({ a: 1, b: 2 }, { a: 1, b: 2 }); // true
shallowEquals({ a: 1 }, { a: 1, b: 2 }); // false (í‚¤ ê°œìˆ˜ ë‹¤ë¦„)
shallowEquals({ a: { x: 1 } }, { a: { x: 1 } }); // false (ì¤‘ì²© ê°ì²´ëŠ” ì°¸ì¡° ë¹„êµ)
shallowEquals([1, 2, 3], [1, 2, 3]); // true
```

**ì™œ ì¤‘ìš”í•œê°€?**

- `useState`ì˜ ì˜ì¡´ì„± ë°°ì—´ ë¹„êµì— ì‚¬ìš©
- props ë³€ê²½ ê°ì§€ì— ì‚¬ìš©
- ì–•ì€ ë¹„êµë§Œìœ¼ë¡œë„ ëŒ€ë¶€ë¶„ì˜ ê²½ìš° ì¶©ë¶„í•©ë‹ˆë‹¤

### 3. `deepEquals(a, b)`

**ì—­í• **: ê¹Šì€ ë¹„êµ - ì¬ê·€ì ìœ¼ë¡œ ëª¨ë“  ì†ì„±ì„ ë¹„êµí•©ë‹ˆë‹¤.

**ë™ì‘ ë°©ì‹**:

1. `Object.is()`ë¡œ ì°¸ì¡° ë™ì¼ì„± í™•ì¸
2. íƒ€ì…ì´ ë‹¤ë¥´ë©´ `false`
3. ì›ì‹œ íƒ€ì…ì€ `Object.is()`ë¡œ ë¹„êµ
4. ê°ì²´/ë°°ì—´: ëª¨ë“  ì¤‘ì²©ëœ ì†ì„±ê¹Œì§€ ì¬ê·€ ë¹„êµ
5. ìˆœí™˜ ì°¸ì¡° ë°©ì§€ (WeakSet ì‚¬ìš©)

**ì˜ˆì‹œ**:

```typescript
deepEquals({ a: { x: 1 } }, { a: { x: 1 } }); // true
deepEquals([1, [2, 3]], [1, [2, 3]]); // true
deepEquals({ a: 1 }, { a: 1, b: undefined }); // false
```

**ì£¼ì˜ì‚¬í•­**:

- ìˆœí™˜ ì°¸ì¡°ê°€ ìˆìœ¼ë©´ ë¬´í•œ ë£¨í”„ì— ë¹ ì§ˆ ìˆ˜ ìˆìŒ
- WeakSetìœ¼ë¡œ ë°©ë¬¸í•œ ê°ì²´ ì¶”ì  í•„ìš”

### 4. `createElement(type, props, ...children)`

**ì—­í• **: JSXë¥¼ VNode ê°ì²´ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.

**ì²˜ë¦¬ ìˆœì„œ**:

1. childrenì„ ë°°ì—´ë¡œ ì •ê·œí™”
2. `isEmptyValue`ë¡œ ë¹ˆ ê°’ í•„í„°ë§
3. propsì— children í¬í•¨
4. VNode ê°ì²´ ìƒì„±

**ì˜ˆì‹œ**:

```typescript
createElement("div", { className: "box" }, "Hello", null, undefined, "World");
// ê²°ê³¼:
{
  type: "div",
  props: {
    className: "box",
    children: ["Hello", "World"]  // null, undefined ì œê±°ë¨
  }
}
```

### 5. `normalizeNode(node)`

**ì—­í• **: ë‹¤ì–‘í•œ íƒ€ì…ì˜ ê°’ì„ VNodeë¡œ ì •ê·œí™”í•©ë‹ˆë‹¤.

**ì²˜ë¦¬ ê·œì¹™**:

- ë¬¸ìì—´/ìˆ«ì â†’ TEXT_ELEMENT íƒ€ì… VNode
- ì´ë¯¸ VNode â†’ ê·¸ëŒ€ë¡œ ë°˜í™˜
- null/undefined/boolean â†’ null ë°˜í™˜

**ì˜ˆì‹œ**:

```typescript
normalizeNode("Hello"); // { type: TEXT_ELEMENT, props: { nodeValue: "Hello" } }
normalizeNode(42); // { type: TEXT_ELEMENT, props: { nodeValue: "42" } }
normalizeNode(null); // null
normalizeNode({ type: "div" }); // ê·¸ëŒ€ë¡œ ë°˜í™˜
```

### 6. `createChildPath(parentPath, index, key)`

**ì—­í• **: ì»´í¬ë„ŒíŠ¸ì˜ ê³ ìœ  ê²½ë¡œë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ì´ ê²½ë¡œëŠ” ë‚˜ì¤‘ì— í›… ìƒíƒœë¥¼ ê²©ë¦¬í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤.

**ê²½ë¡œ í˜•ì‹**:

- key ì—†ìŒ: `"ë¶€ëª¨ê²½ë¡œ.cì¸ë±ìŠ¤"` (ì˜ˆ: `"0.c0"`, `"0.c1"`)
- key ìˆìŒ: `"ë¶€ëª¨ê²½ë¡œ.ií‚¤"` (ì˜ˆ: `"0.i1"`, `"0.i2"`)
- ë£¨íŠ¸: `"0"`

**ì˜ˆì‹œ**:

```typescript
createChildPath("0", 0, null); // "0.c0"
createChildPath("0", 1, "item-1"); // "0.iitem-1"
createChildPath("0.c0", 0, null); // "0.c0.c0"
```

**ì™œ ì¤‘ìš”í•œê°€?**

- ê° ì»´í¬ë„ŒíŠ¸ëŠ” ê³ ìœ í•œ ê²½ë¡œë¥¼ ê°€ì§
- ê²½ë¡œë¥¼ í†µí•´ í›… ìƒíƒœë¥¼ ê²©ë¦¬
- ê°™ì€ ì»´í¬ë„ŒíŠ¸ë¼ë„ ìœ„ì¹˜ê°€ ë‹¤ë¥´ë©´ ë‹¤ë¥¸ ìƒíƒœë¥¼ ê°€ì§

---

## ğŸ“ í•™ìŠµ ì²´í¬ë¦¬ìŠ¤íŠ¸

ì´ ë‹¨ê³„ë¥¼ ì™„ë£Œí–ˆë‹¤ë©´ ë‹¤ìŒì„ ì´í•´í•  ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤:

- [ ] Virtual DOMì´ ë¬´ì—‡ì´ê³  ì™œ í•„ìš”í•œì§€ ì„¤ëª…í•  ìˆ˜ ìˆë‹¤
- [ ] VNode êµ¬ì¡°ë¥¼ ì„¤ëª…í•˜ê³  ê°„ë‹¨í•œ VNodeë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤
- [ ] `isEmptyValue`ê°€ ì™œ í•„ìš”í•œì§€ ì´í•´í•œë‹¤
- [ ] `shallowEquals`ì™€ `deepEquals`ì˜ ì°¨ì´ë¥¼ ì„¤ëª…í•  ìˆ˜ ìˆë‹¤
- [ ] `createElement`ê°€ JSXë¥¼ ì–´ë–»ê²Œ ë³€í™˜í•˜ëŠ”ì§€ ì´í•´í•œë‹¤
- [ ] ê²½ë¡œ(Path)ê°€ ì»´í¬ë„ŒíŠ¸ ìƒíƒœ ê²©ë¦¬ì— ì–´ë–»ê²Œ ì‚¬ìš©ë˜ëŠ”ì§€ ì´í•´í•œë‹¤

---

## âš ï¸ ìì£¼ í•˜ëŠ” ì‹¤ìˆ˜

### 1. boolean ê°’ í•„í„°ë§ ì‹¤ìˆ˜

```typescript
// âŒ ì˜ëª»ëœ ì˜ˆ
if (value) return true; // 0ë„ í•„í„°ë§ë¨!

// âœ… ì˜¬ë°”ë¥¸ ì˜ˆ
if (value === null || value === undefined || typeof value === "boolean") {
  return true;
}
```

### 2. shallowEqualsì—ì„œ ì¤‘ì²© ê°ì²´ ë¹„êµ

```typescript
// âŒ ê¹Šì€ ë¹„êµ í•˜ë©´ ì•ˆ ë¨
for (const key in a) {
  if (!deepEquals(a[key], b[key])) return false; // shallowEqualsì¸ë°!
}

// âœ… 1ë‹¨ê³„ë§Œ ë¹„êµ
for (const key in a) {
  if (!Object.is(a[key], b[key])) return false;
}
```

### 3. ê²½ë¡œ ìƒì„± ì‹œ key ìš°ì„ ìˆœìœ„

```typescript
// âŒ ì˜ëª»ëœ ì˜ˆ
const path = key ? `c${index}` : `i${key}`; // ìˆœì„œ ë°”ë€œ!

// âœ… ì˜¬ë°”ë¥¸ ì˜ˆ
const path = key ? `i${key}` : `c${index}`;
```

---

## ğŸ’¡ ì‹¤ìŠµ ì˜ˆì œ

ë‹¤ìŒ ì½”ë“œë¥¼ ì§ì ‘ ì‹¤í–‰í•´ë³´ë©´ì„œ ì´í•´í•˜ì„¸ìš”:

```typescript
// 1. createElement í…ŒìŠ¤íŠ¸
const vnode = createElement(
  "div",
  { className: "container" },
  createElement("h1", null, "Title"),
  null,
  undefined,
  createElement("p", null, "Content"),
);

console.log(vnode);
// childrenì— null, undefinedê°€ ì—†ì–´ì•¼ í•¨

// 2. shallowEquals vs deepEquals
const obj1 = { a: { x: 1 } };
const obj2 = { a: { x: 1 } };

console.log(shallowEquals(obj1, obj2)); // false (ì°¸ì¡° ë‹¤ë¦„)
console.log(deepEquals(obj1, obj2)); // true (ë‚´ìš© ê°™ìŒ)

// 3. ê²½ë¡œ ìƒì„±
console.log(createChildPath("0", 0, null)); // "0.c0"
console.log(createChildPath("0", 1, "myKey")); // "0.imyKey"
```

---

## ğŸ”„ ë‹¤ìŒ ë‹¨ê³„ë¡œ ê°€ê¸° ì „ì—

ì´ ë‹¨ê³„ë¥¼ ì™„ë£Œí•˜ë©´ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•´ë³´ì„¸ìš”:

```bash
npm test basic.equals.test.tsx
```

ëª¨ë“  í…ŒìŠ¤íŠ¸ê°€ í†µê³¼í•˜ë©´ ë‹¤ìŒ ë‹¨ê³„ì¸ **ì»¨í…ìŠ¤íŠ¸ì™€ ë£¨íŠ¸ ì´ˆê¸°í™”**ë¡œ ë„˜ì–´ê°ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤!

---

## ğŸ“– ì¶”ê°€ í•™ìŠµ ìë£Œ

ë” ê¹Šì´ ì´í•´í•˜ê³  ì‹¶ë‹¤ë©´:

- `docs/03-fundamental-knowledge.md` - VNodeì™€ ì»´í¬ë„ŒíŠ¸ ëª¨ë¸ ì„¹ì…˜
- `docs/01-implementation-guide.md` - í•¨ìˆ˜ ì¸í„°í˜ì´ìŠ¤ ì„¹ì…˜
